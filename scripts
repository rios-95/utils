hola() {
  echo "Hola"
}

#Recibe los par√°metros: <usuario> <contenido public key file>
#Por ejemplo: createsshuser bob ssh-rsa AAAA...B3FBdxaQ== bob@example.com
createsshuser() {
  USER="$1"
  shift

  SSH_PUBLIC_KEY="$*"

  PASSWORD=$(cat /dev/urandom | tr -dc 'a-zA-Z0-9' | fold -w 32 | head -n 1)

  # create a user with a random password
  adduser ${USER}
  echo ${USER}:${PASSWORD} | chpasswd

  # add the user to the itport group
  #  usermod -a -G itport ${USER}

  # add the ssh public key
  su - ${USER} -c "umask 022 ; mkdir .ssh ; echo $SSH_PUBLIC_KEY >> .ssh/authorized_keys"
}

case $1 in
hola)
  hola
  ;;
createsshuser)
  shift
  createsshuser $*
  ;;
esac
